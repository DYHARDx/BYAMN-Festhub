<!-- In your index.html file, replace the script section with this: -->
<script>
    document.addEventListener('DOMContentLoaded', () => {
      const urlInput = document.getElementById('url');
      const generateBtn = document.getElementById('generate');
      const resultDiv = document.getElementById('result');
      const generatedUrl = document.getElementById('generated-url');
      const copyBtn = document.getElementById('copy');
      const openBtn = document.getElementById('open');
      
      generateBtn.addEventListener('click', () => {
        try {
          // First validate the URL
          let inputUrl = urlInput.value.trim();
          
          // Add https:// if missing
          if (!inputUrl.startsWith('http://') && !inputUrl.startsWith('https://')) {
            inputUrl = 'https://' + inputUrl;
          }
          
          // Validate URL
          new URL(inputUrl); // This will throw if invalid
          
          // Encode and create redirect URL
          const encodedUrl = encodeURIComponent(inputUrl);
          const currentPath = window.location.href.replace('index.html', '');
          const redirectUrl = `${currentPath}redirect.html?url=${encodedUrl}`;
          
          generatedUrl.value = redirectUrl;
          resultDiv.style.display = 'block';
          
          // Scroll to result
          resultDiv.scrollIntoView({ behavior: 'smooth', block: 'center' });
        } catch (e) {
          const shouldProceed = confirm('This doesn\'t look like a valid URL. Generate link anyway?');
          if (shouldProceed) {
            const encodedUrl = encodeURIComponent(urlInput.value);
            const currentPath = window.location.href.replace('index.html', '');
            generatedUrl.value = `${currentPath}redirect.html?url=${encodedUrl}`;
            resultDiv.style.display = 'block';
            resultDiv.scrollIntoView({ behavior: 'smooth', block: 'center' });
          }
        }
      });
      
      copyBtn.addEventListener('click', () => {
        generatedUrl.select();
        document.execCommand('copy');
        copyBtn.textContent = 'Copied!';
        setTimeout(() => copyBtn.textContent = 'Copy Link', 2000);
      });
      
      openBtn.addEventListener('click', () => {
        window.open(generatedUrl.value, '_blank');
      });
      
      // Make buttons keyboard accessible
      [generateBtn, copyBtn, openBtn].forEach(btn => {
        btn.addEventListener('keydown', (e) => {
          if (e.key === 'Enter' || e.key === ' ') {
            e.preventDefault();
            btn.click();
          }
        });
      });
    });
</script>
